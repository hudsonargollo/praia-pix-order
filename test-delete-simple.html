<!DOCTYPE html>
<html>
<head>
    <title>Test Delete Waiter</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Test Delete Waiter Function</h1>
    <button onclick="testDelete()">Test Delete</button>
    <pre id="output"></pre>

    <script>
        const SUPABASE_URL = 'YOUR_SUPABASE_URL';
        const SUPABASE_ANON_KEY = 'YOUR_ANON_KEY';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        async function testDelete() {
            const output = document.getElementById('output');
            output.textContent = 'Testing...\n';

            try {
                // Get session
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();
                
                if (sessionError || !session) {
                    output.textContent += 'ERROR: No session\n';
                    output.textContent += JSON.stringify(sessionError, null, 2);
                    return;
                }

                output.textContent += 'Session found\n';
                output.textContent += `User: ${session.user.email}\n\n`;

                // Test with a fake UUID
                const fakeId = '00000000-0000-0000-0000-000000000000';
                
                output.textContent += `Calling delete-waiter with ID: ${fakeId}\n\n`;

                const { data, error } = await supabase.functions.invoke('delete-waiter', {
                    body: { waiterId: fakeId },
                    headers: {
                        Authorization: `Bearer ${session.access_token}`
                    }
                });

                output.textContent += 'Response:\n';
                output.textContent += JSON.stringify({ data, error }, null, 2);

            } catch (err) {
                output.textContent += 'EXCEPTION:\n';
                output.textContent += JSON.stringify(err, null, 2);
            }
        }
    </script>
</body>
</html>
